#!/usr/bin/env bash
# script to build the site locally

site_dir="__site"
postprocess="src/postprocess"
filter="bin/filter"

# build site
julia --project="@." --optimize=0 --color=yes --eval "using Franklin: optimize
  optimize(clear=true, prerender=true, minify=false)" 2> >("$filter" >&2) &&

# post-processing
python "$postprocess" --verbose "$site_dir" &&
# don't ignore files in .gitignore
prettier --write "$site_dir" --ignore-path=.prettierignore
